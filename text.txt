문장이나 영상, 음성을 만들어 내는 인공 지능 생성 모델 중
확산 모델은 영상의 복원, 생성 및 변환에 뛰어난 성능을 보인다.
확산 모델의 기본 발상은, 원본 이미지에 노이즈를 점진적으로
추가하였다가 그 노이즈를 다시 제거해 나가면 원본 이미지를
복원할 수 있다는 것이다. 노이즈는 불필요하거나 원하지 않는
값을 의미한다. 원하는 값만 들어 있는 원본 이미지에 노이즈를
단계별로 더하면 노이즈가 포함된 확산 이미지가 되고, 여러
단계를 거치면 결국 원본 이미지가 어떤 이미지였는지 전혀
알아볼 수 없는 노이즈 이미지가 된다. 역으로, 단계별로 더해진
노이즈를 알 수 있다면 노이즈 이미지에서 원본 이미지를 복원할
수 있다. 확산 모델은 노이즈 생성기, 이미지 연산기, 노이즈
예측기로 구성되며, 순확산 과정과 역확산 과정 순으로 작동한다.
순확산 과정은 이미지에 노이즈를 추가하면서 노이즈 예측기를
학습시키는 과정이다. 첫 단계에서는, 노이즈 생성기에서 노이즈를
만든 후 이미지 연산기가 이 노이즈를 원본 이미지에 더해서
노이즈가 포함된 확산 이미지를 출력한다. 다음 단계부터는
노이즈 생성기에서 만든 노이즈를 이전 단계에서 출력된 확산
이미지에 더한다. 이러한 단계를 충분히 반복하면 최종적으로
노이즈 이미지가 출력된다. 이때 더해지는 노이즈는 크기나 분포
양상 등 그 특성이 단계별로 다르다. 따라서 노이즈 예측기는
단계별로 확산 이미지를 입력받아 이미지에 포함된 노이즈의
특성을 추출하여 수치들로 표현하고, 이 수치들을 바탕으로
노이즈를 예측한다. 노이즈 예측기 내부의 이러한 수치들을
잠재 표현 이라고 한다. 노이즈 예측기는 잠재 표현을 구하고
노이즈를 예측하는 방식을 학습한다.
노이즈 예측기의 학습 방법은 기계 학습 중에서 지도 학습에
해당한다. 지도 학습은 학습 데이터에 정답이 주어져 출력과
정답의 차이가 작아지도록 모델을 학습시키는 방법이다. 노이즈
예측기를 학습시킬 때는 노이즈 생성기에서 만들어 넣어 준
노이즈가 정답에 해당하며 이 노이즈와 예측된 노이즈 사이의
차이가 작아지도록 학습시킨다.
역확산 과정은 노이즈 이미지에서 노이즈를 제거하여 원본
이미지를 복원하는 과정이다. 노이즈를 제거하려면 이미지에
단계별로 어떤 특성의 노이즈가 더해졌는지 알아야 하는데
노이즈 예측기가 이 역할을 한다. 노이즈 이미지 또는 중간
단계에서의 확산 이미지를 노이즈 예측기에 입력하면 이미지에
포함된 노이즈의 특성을 추출하여 잠재 표현을 구하고 이를
바탕으로 노이즈를 예측한다. 이미지 연산기는 입력된 확산
이미지로부터 이 노이즈를 빼서 현 단계의 노이즈를 제거한 확산
이미지를 출력한다. 확산 이미지에 이런 단계를 반복하면 결국
노이즈가 대부분 제거되어 원본 이미지에 가까운 이미지만 남게
된다.
한편, 많은 종류의 이미지를 학습시킨 후 학습된 이미지의
잠재 표현에 고유 번호를 붙이면 역확산 과정에서 이미지를
선택하여 생성할 수 있다. 또한 잠재 표현의 수치들을 조정하면
다른 특성의 노이즈가 생성되어 여러 이미지를 혼합하거나
실재하지 않는 이미지를 만들어 낼 수도 있다